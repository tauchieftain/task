(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["systemUser"],{"6d53":function(e,a,t){"use strict";t("763e")},"763e":function(e,a,t){},b979:function(e,a,t){"use strict";t.r(a);var l=function(){var e=this,a=e._self._c;return a("div",{staticClass:"page-wrapper common-page"},[a("div",{staticClass:"top-single-title"},[e._v("人员管理")]),a("div",{staticClass:"top-tools"},[a("el-form",{staticClass:"kw-el-form-class",attrs:{inline:!0,size:"small"}},[a("el-form-item",{attrs:{label:"用户名称"}},[a("el-input",{attrs:{placeholder:"请输入用户名称",clearable:""},model:{value:e.searchForm.name,callback:function(a){e.$set(e.searchForm,"name",a)},expression:"searchForm.name"}})],1),a("el-form-item",{attrs:{label:"角色组"}},[a("el-select",{staticClass:"dialog-select",attrs:{filterable:"",clearable:"",placeholder:"请选择角色组"},model:{value:e.searchForm.role_id,callback:function(a){e.$set(e.searchForm,"role_id",a)},expression:"searchForm.role_id"}},e._l(e.selectOption,(function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleClickSearch}},[e._v("查询")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.handleClickReset}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"page-table-container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"kw-table-data",attrs:{data:e.tableData,"max-height":e.tableHeight,border:"",size:"small","row-key":"id"}},[a("el-table-column",{attrs:{prop:"id",label:"用户ID"}}),a("el-table-column",{attrs:{prop:"real_name",label:"用户名称"}}),a("el-table-column",{attrs:{prop:"role_name",label:"角色组"}}),a("el-table-column",{attrs:{prop:"add_time",label:"分配时间"}}),a("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"getPermission",rawName:"v-getPermission",value:"bind-role",expression:"'bind-role'"}],attrs:{type:"text",size:"small"},on:{click:function(a){return e.editDialog(t.row)}}},[e._v("绑定角色")])]}}])})],1)],1),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"500px"},on:{"update:visible":function(a){e.dialogVisible=a}}},[a("el-form",{ref:"dialogForm",attrs:{"label-width":"80px",size:"small",model:e.dialogForm,"label-position":"left"}},[a("el-form-item",{attrs:{label:"用户",prop:"name"}},[a("el-input",{attrs:{readonly:""},model:{value:e.dialogForm.real_name,callback:function(a){e.$set(e.dialogForm,"real_name",a)},expression:"dialogForm.real_name"}})],1),a("el-form-item",{attrs:{label:"角色组",prop:"parent_id"}},[a("el-select",{staticClass:"dialog-select",attrs:{filterable:"",placeholder:"请选择角色组"},model:{value:e.dialogForm.role_id,callback:function(a){e.$set(e.dialogForm,"role_id",a)},expression:"dialogForm.role_id"}},e._l(e.selectOption,(function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.dialogSubmitLoading},on:{click:e.submitDialog}},[e._v("确定")]),a("el-button",{attrs:{size:"small"},on:{click:function(a){e.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)},i=[],s={data(){return{tableHeight:document.documentElement.clientHeight-240,tableData:[],allData:[],roleList:[],total:0,allTotal:0,currentPage:1,pageSize:10,searchForm:{name:"",role_id:""},tableLoading:!1,selectOption:[],dialogVisible:!1,dialogForm:{},dialogTitle:"",refreshLoading:!1,dialogSubmitLoading:!1}},methods:{handleClickSearch(){this.searchForm.name||this.searchForm.role_id?this.tableData=this.allData.filter(e=>e.real_name.includes(this.searchForm.name)&&(!this.searchForm.role_id||this.searchForm.role_id==e.role_id)):this.tableData=this.allData},handleClickReset(){this.searchForm={name:"",role_id:""}},editDialog(e){this.dialogTitle="编辑角色",this.dialogForm={user_id:e.id,real_name:e.real_name,role_id:+e.role_id||""},this.dialogVisible=!0},getTableData(){this.tableLoading=!0,this.$api.rbac.getUserList().then(e=>{0==e.code?(this.allData=e.data.list,this.handleClickSearch()):this.$message.error(e.msg)}).finally(()=>{this.tableLoading=!1})},submitDialog(){this.dialogForm.role_id?(this.dialogSubmitLoading=!0,this.$api.rbac.setUserRole(this.dialogForm).then(e=>{const{code:a,msg:t}=e;0==a?(this.$message.success(t),this.dialogVisible=!1,this.getTableData()):this.$message.error(t)}).finally(()=>{this.dialogSubmitLoading=!1})):this.$message.warning("请选择角色")},getSelectOption(){this.$api.rbac.getRoleList({role_status:0}).then(e=>{0==e.code?this.selectOption=e.data:this.$message.error(e.msg)})},refreshUser(){this.refreshLoading=!0,this.$api.rbac.refreshUserList().then(e=>{0==e.code?(this.$message.success(e.msg),this.getTableData()):this.$message.error(e.msg)}).finally(()=>{this.refreshLoading=!1})}},mounted(){this.getTableData(),this.getSelectOption()}},o=s,r=(t("6d53"),t("2877")),n=Object(r["a"])(o,l,i,!1,null,"753627fd",null);a["default"]=n.exports}}]);