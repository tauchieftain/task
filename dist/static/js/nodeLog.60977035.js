(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["nodeLog"],{cc25:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-wrapper common-page"},[t("div",{staticClass:"top-single-title"},[e._v("节点日志")]),t("div",{staticClass:"top-tools"},[t("el-form",{staticClass:"kw-el-form-class",attrs:{inline:!0,size:"small"},on:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"用户"}},[t("el-select",{attrs:{placeholder:"请选择用户",filterable:"",clearable:""},model:{value:e.searchForm.user_id,callback:function(t){e.$set(e.searchForm,"user_id",t)},expression:"searchForm.user_id"}},e._l(e.userList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.real_name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"操作类型"}},[t("el-select",{attrs:{placeholder:"请选择操作类型",filterable:"",clearable:""},model:{value:e.searchForm.action,callback:function(t){e.$set(e.searchForm,"action",t)},expression:"searchForm.action"}},e._l(e.actionList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"操作对象"}},[t("el-select",{attrs:{placeholder:"请选择操作对象",filterable:"",clearable:""},model:{value:e.searchForm.object,callback:function(t){e.$set(e.searchForm,"object",t)},expression:"searchForm.object"}},e._l(e.objectList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"节点名称"}},[t("el-select",{attrs:{placeholder:"请选择节点",filterable:"",clearable:""},model:{value:e.searchForm.node_id,callback:function(t){e.$set(e.searchForm,"node_id",t)},expression:"searchForm.node_id"}},e._l(e.nodeList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("查询")]),t("el-button",{attrs:{type:"text"},on:{click:e.handleReset}},[e._v("清空")])],1)],1)],1),t("div",{staticClass:"page-table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"kw-table-data",attrs:{data:e.tableData,border:"",size:"small","row-key":"id"}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"80px"}}),t("el-table-column",{attrs:{prop:"object",label:"操作对象",width:"200px"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(e.getObjectValue(t.object))+" ")]}}])}),t("el-table-column",{attrs:{prop:"action",label:"操作类型",width:"200px"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(e.getActionValue(t.action))+" ")]}}])}),t("el-table-column",{attrs:{prop:"content",label:"消息内容"}}),t("el-table-column",{attrs:{prop:"user_name",label:"操作人",width:"200px"}}),t("el-table-column",{attrs:{prop:"time",label:"操作时间",width:"200px"}})],1),t("el-pagination",{attrs:{align:"center","current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])},s=[],l=(a("14d9"),{data(){return{searchForm:{user_id:"",action:"",object:"",node_id:""},userList:[],nodeList:[],actionList:[{id:"Add",name:"新增"},{id:"Edit",name:"修改"},{id:"Del",name:"删除"},{id:"Audit",name:"审核"},{id:"Start",name:"开启"},{id:"Stop",name:"停止"},{id:"Exec",name:"执行"},{id:"Kill",name:"强杀"}],objectList:[{id:"Node",name:"节点"},{id:"Crontab",name:"定时任务"},{id:"Daemon",name:"常驻任务"}],tableData:[],tableLoading:!1,currentPage:1,pageSize:10,total:0}},mounted(){this.getList(),this.getOptions()},methods:{handleReset(){this.searchForm={user_id:"",action:"",object:"",node_id:""}},handleSearch(){this.currentPage=1,this.getList()},getOptions(){this.$api.rbac.getUserList().then(e=>{0==e.code?this.userList=e.data.list:this.$message.error(e.msg)}),this.$api.node.getNodeList({page:1,page_size:1e3}).then(e=>{0==e.code?this.nodeList=e.data.list:this.$message.error(e.msg)})},getList(){this.tableLoading=!0,this.$api.node.getNodeLogList({page:this.currentPage,page_size:this.pageSize,user_id:this.searchForm.user_id||void 0,action:this.searchForm.action||void 0,object:this.searchForm.object||void 0,node_id:this.searchForm.node_id||void 0}).then(e=>{0==e.code?(this.tableData=e.data.list,this.total=e.data.total):this.$message.error(e.msg)}).finally(()=>{this.tableLoading=!1})},handleSizeChange(e){this.pageSize=e,this.getList()},handleCurrentChange(e){this.currentPage=e,this.getList()},getObjectValue(e){const t=this.objectList.find(t=>t.id==e);return t?t.name:e},getActionValue(e){const t=this.actionList.find(t=>t.id==e);return t?t.name:""},toDetail(e){this.$router.push({path:"/node/crontab",query:{addr:e.address,node_id:e.id}})},toConfig(){this.$router.push({path:"/node/config"})}}}),o=l,r=a("2877"),n=Object(r["a"])(o,i,s,!1,null,null,null);t["default"]=n.exports}}]);