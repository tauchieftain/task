(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["interface"],{"7e7a":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-wrapper common-page"},[t("div",{staticClass:"top-single-title"},[e._v("接口管理")]),t("div",{staticClass:"top-tools"},[t("div"),t("div",[t("el-button",{directives:[{name:"getPermission",rawName:"v-getPermission",value:"add-interface",expression:"'add-interface'"}],attrs:{type:"primary"},on:{click:e.showAddDialog}},[e._v("新增接口")]),t("el-button",{directives:[{name:"getPermission",rawName:"v-getPermission",value:"add-category",expression:"'add-category'"}],attrs:{type:"primary"},on:{click:e.showCategoryAddDialog}},[e._v("新增分类")])],1)]),0===e.interfaceList.length?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}]},[t("el-empty",{attrs:{description:"暂无数据"}})],1):t("div",{staticClass:"page-container"},[t("interface-list",{attrs:{interfaceList:e.interfaceList},on:{editCategory:e.showCategoryEditDialog,delCategory:e.handleDelCategory,editInterface:e.showInterfaceEditDialog,delInterface:e.handleDelInterface}})],1),t("el-dialog",{attrs:{title:e.editCategoryForm&&e.editCategoryForm.id?"编辑接口分类":"新增接口分类",visible:e.editCategoryDialogVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.editCategoryDialogVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.editCategoryDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary",loading:e.dialogSubmitLoading},on:{click:e.categoryDialogSubmit}},[e._v("确 定")])]},proxy:!0}])},[t("div",[t("el-form",{ref:"form",attrs:{"label-width":"80px",size:"small"},on:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"分类名称"}},[t("el-input",{attrs:{placeholder:"请输入接口分类名称"},model:{value:e.editCategoryForm.name,callback:function(t){e.$set(e.editCategoryForm,"name",t)},expression:"editCategoryForm.name"}})],1),t("el-form-item",{attrs:{label:"所属分类"}},[t("el-cascader",{staticClass:"full-input",staticStyle:{width:"100%"},attrs:{options:e.treeList,filterable:"",clearable:"",placeholder:"请选择接口分类，不填为顶级分类",props:{checkStrictly:!0,label:"name",value:"id",emitPath:!1}},model:{value:e.editCategoryForm.parent_id,callback:function(t){e.$set(e.editCategoryForm,"parent_id",t)},expression:"editCategoryForm.parent_id"}})],1),t("el-form-item",{attrs:{label:"排序"}},[t("el-input",{attrs:{placeholder:"请输入排序"},model:{value:e.editCategoryForm.sort,callback:function(t){e.$set(e.editCategoryForm,"sort",t)},expression:"editCategoryForm.sort"}})],1)],1)],1)]),t("el-dialog",{attrs:{title:e.editForm&&e.editForm.id?"编辑接口":"新增接口",visible:e.editDialogVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.editDialogVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"small",type:"primary",loading:e.dialogSubmitLoading},on:{click:e.interfaceDialogSubmit}},[e._v("确 定")])]},proxy:!0}])},[t("div",[t("el-form",{ref:"form",attrs:{"label-width":"80px",size:"small"},on:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"接口名称"}},[t("el-input",{attrs:{placeholder:"请输入接口名称"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),t("el-form-item",{attrs:{label:"接口路由"}},[t("el-input",{attrs:{placeholder:"请输入接口路由"},model:{value:e.editForm.route,callback:function(t){e.$set(e.editForm,"route",t)},expression:"editForm.route"}})],1),t("el-form-item",{attrs:{label:"所属分类"}},[t("el-cascader",{staticClass:"full-input",staticStyle:{width:"100%"},attrs:{options:e.treeList,filterable:"",clearable:"",placeholder:"请选择接口分类",props:{checkStrictly:!0,label:"name",value:"id",emitPath:!1}},model:{value:e.editForm.category_id,callback:function(t){e.$set(e.editForm,"category_id",t)},expression:"editForm.category_id"}})],1),t("el-form-item",{attrs:{label:"接口描述"}},[t("el-input",{attrs:{placeholder:"请输入接口描述"},model:{value:e.editForm.desc,callback:function(t){e.$set(e.editForm,"desc",t)},expression:"editForm.desc"}})],1),t("el-form-item",{attrs:{label:"排序"}},[t("el-input",{attrs:{placeholder:"请输入排序"},model:{value:e.editForm.sort,callback:function(t){e.$set(e.editForm,"sort",t)},expression:"editForm.sort"}})],1)],1)],1)])],1)},s=[],r=function(){var e=this,t=e._self._c;return t("div",[t("el-collapse",{attrs:{accordion:""},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.interfaceList,(function(i){return t("el-collapse-item",{key:i.id,attrs:{title:i.name,name:i.id},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"collapse-title"},[t("div",[e._v(" "+e._s(i.name)+" "),t("i",{directives:[{name:"getPermission",rawName:"v-getPermission",value:"edit-category",expression:"'edit-category'"}],staticClass:"el-icon el-icon-edit-outline",on:{click:function(t){return t.stopPropagation(),e.editCategory(i)}}}),t("i",{directives:[{name:"getPermission",rawName:"v-getPermission",value:"del-category",expression:"'del-category'"}],staticClass:"el-icon el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.delCategory(i.id)}}})])])]},proxy:!0}],null,!0)},[i.children&&i.children.length>0?[t("div",{staticStyle:{"padding-left":"12px","padding-bottom":"12px"}},[t("interface-list",{attrs:{interfaceList:i.children},on:{editCategory:e.editCategory,delCategory:e.delCategory,editInterface:e.editInterface,delInterface:e.delInterface}})],1)]:e._e(),i.interfaces&&i.interfaces.length>0?[t("el-table",{attrs:{data:i.interfaces,"row-key":"id",border:""}},[t("el-table-column",{attrs:{prop:"name",label:"接口名称"}}),t("el-table-column",{attrs:{prop:"route",label:"接口路由"}}),t("el-table-column",{attrs:{prop:"desc",label:"接口描述"}}),t("el-table-column",{attrs:{prop:"create_time",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(e.getComputedDate(t.create_time,!0))+" ")]}}],null,!0)}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-button",{directives:[{name:"getPermission",rawName:"v-getPermission",value:"edit-interface",expression:"'edit-interface'"}],attrs:{type:"text",size:"small"},on:{click:function(t){return e.editInterface(i)}}},[e._v("编辑")]),t("el-button",{directives:[{name:"getPermission",rawName:"v-getPermission",value:"del-interface",expression:"'del-interface'"}],staticClass:"danger-btn",attrs:{type:"text",size:"small"},on:{click:function(t){return e.delInterface(i.id)}}},[e._v("删除")])]}}],null,!0)})],1)]:e._e()],2)})),1)],1)},o=[],l={name:"interfaceList",props:{interfaceList:Array},data(){return{activeNames:[]}},methods:{editCategory(e){this.$emit("editCategory",e)},delCategory(e){this.$emit("delCategory",e)},editInterface(e){this.$emit("editInterface",e)},delInterface(e){this.$emit("delInterface",e)}}},n=l,d=(i("f50e"),i("2877")),c=Object(d["a"])(n,r,o,!1,null,"2dbe0846",null),m=c.exports,g={components:{interfaceList:m},data(){return{interfaceList:[],pageLoading:!1,editCategoryDialogVisible:!1,editCategoryForm:{id:"",name:"",parent_id:"",sort:""},treeList:[],editDialogVisible:!1,editForm:{id:void 0,name:"",route:"",category_id:"",desc:"",sort:""},dialogSubmitLoading:!1}},created(){this.getList()},methods:{getList(){this.pageLoading=!0,this.$api.rbac.getInterfaceCategoryList().then(e=>{0===e.code?(this.interfaceList=e.data||[],this.getTreeList(e.data)):this.$message.error(e.msg)}).finally(()=>{this.pageLoading=!1})},getTreeList(e){const t=e=>{e.forEach(e=>{e.children&&0==e.children.length?delete e.children:e.children&&t(e.children)})};let i=JSON.parse(JSON.stringify(e));t(i),this.treeList=i},showCategoryAddDialog(){this.editCategoryDialogVisible=!0,this.editCategoryForm={id:void 0,name:"",parent_id:"",sort:""}},showCategoryEditDialog(e){this.editCategoryDialogVisible=!0,this.editCategoryForm={id:e.id,name:e.name,parent_id:e.parent_id||"",sort:e.sort}},categoryDialogSubmit(){this.editCategoryForm.name?(this.editCategoryForm.parent_id||(this.editCategoryForm.parent_id=0),this.dialogSubmitLoading=!0,this.editCategoryForm.sort=+this.editCategoryForm.sort,this.editCategoryForm.id?this.$api.rbac.editInterfaceCategory(this.editCategoryForm).then(e=>{0===e.code?(this.$message.success(e.msg),this.getList(),this.editCategoryDialogVisible=!1):this.$message.error(e.msg)}).finally(()=>{this.dialogSubmitLoading=!1}):this.$api.rbac.addInterfaceCategory(this.editCategoryForm).then(e=>{0===e.code?(this.$message.success(e.msg),this.getList(),this.editCategoryDialogVisible=!1):this.$message.error(e.msg)}).finally(()=>{this.dialogSubmitLoading=!1})):this.$message.warning("请输入分类名称")},handleDelCategory(e){this.$confirm("是否删除该接口分类?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$api.rbac.delInterfaceCategory({id:e}).then(e=>{0===e.code?(this.$message.success(e.msg),this.getList()):this.$message.error(e.msg)})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},showAddDialog(){this.editDialogVisible=!0,this.editForm={id:void 0,name:"",route:"",category_id:"",desc:"",sort:""}},showInterfaceEditDialog(e){this.editForm={id:e.id,name:e.name,route:e.route,category_id:e.category_id,desc:e.desc,sort:e.sort},this.editDialogVisible=!0},interfaceDialogSubmit(){this.editForm.name?this.editForm.route?this.editForm.category_id?(this.dialogSubmitLoading=!0,this.editForm.sort=+this.editForm.sort,this.editForm.id?this.$api.rbac.editInterface(this.editForm).then(e=>{0===e.code?(this.$message.success(e.msg),this.getList(),this.editDialogVisible=!1):this.$message.error(e.msg)}).finally(()=>{this.dialogSubmitLoading=!1}):this.$api.rbac.addInterface(this.editForm).then(e=>{0===e.code?(this.$message.success(e.msg),this.getList(),this.editDialogVisible=!1):this.$message.error(e.msg)}).finally(()=>{this.dialogSubmitLoading=!1})):this.$message.warning("请选择接口分类"):this.$message.warning("请输入接口路由"):this.$message.warning("请输入接口名称")},handleDelInterface(e){this.$confirm("是否删除该接口?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$api.rbac.delInterface({ids:[e]}).then(e=>{0===e.code?(this.$message.success(e.msg),this.getList()):this.$message.error(e.msg)})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}}},u=g,h=(i("c3d3"),Object(d["a"])(u,a,s,!1,null,"09157658",null));t["default"]=h.exports},"7f0f":function(e,t,i){},baf9:function(e,t,i){},c3d3:function(e,t,i){"use strict";i("7f0f")},f50e:function(e,t,i){"use strict";i("baf9")}}]);